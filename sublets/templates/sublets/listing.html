{% extends 'sublets/layout.html' %}
{% load static %}
{% block title %}
Sublets - Listing Detail
{% endblock title %}

{% block head %}
<link rel="stylesheet" href="{% static 'sublets/css/listing.css' %}">
{% endblock head %}

{% block body %}
<h1>Listing Detail</h1>
    

<div class="container-fluid">
    <div class="row">
      {% for p in pictures %}
        <div class="col-4 col-md-3 mb-2">
          <div class="square-thumbnail" style="background-image: url('{{ p.picture.url }}');"></div>
        </div>
      {% empty %}
        <p>(Listing has no images)</p>
      {% endfor %}
    </div>
  </div>

  {{ listing.get_listing_type_display }}: ${{ listing.rent }} per month<br>
  {{ listing.bedroom_count }} bedroom{% if listing.bedroom_count|add:0 > 1 %}s{% endif %}, 
  {{ listing.bathroom_count }} bathroom{% if listing.bathroom_count|add:0 > 1 %}s{% endif %} <br><br>
  <strong>Address:</strong><br>
  {{ listing.address_line_1 }}<br> {{ listing.city }}, {{ listing.state }} {{ listing.zip_code }}<br><br>
  Available: {{ listing.start_date|date:"F j" }} to {{ listing.end_date|date:"F j" }}<br>
  Last updated: {{ listing.updated_at|date:"F j, Y" }}
  <br><br>
  <form action="{% url 'send_message' %}" method="post">
    <!-- Work in progress -->
    # need sender, recipient, listing, body
    {% csrf_token %}
    <input type="hidden" name="sender" value={{ listing.created_by.id }}>
    {{ send_message_form.non_field_errors }}
    {{ send_message_form.body.errors }}
    <label for="{{ send_message_form.body.id_for_label }}">Send a message:</label><br>
    {{ send_message_form.body }}

  <button type="submit">Send</button>
  </form>
</div>
{% endblock body %}